### Executando e administrando containers Docker

# install docker
curl -fsSL https://get.docker.com/ | bash

docker version

docker container ls                                   # versão antiga -> docker ps

docker image ls                                       # versão antiga -> docker images
docker container ls -a                                # versão antiga -> docker ps -a

docker container run hello-world                      # cria e executa o container, se não existir a imagem hello-world a imagem é baixada do docker registry. Versão antiga -> docker run hello-world
docker container run -ti centos                       # cria e executa container com terminal
docker container run -ti ubuntu                       # cria e executa container com terminal
docker container run -d nginx                         # cria e executa o container como daemon (background)
docker container run --rm -it centos /bin/bash        # cria e executa comando /bin/bash no container, após execução o container é removido
docker container run -d -m 128M --cpus 0.5 nginx      # cria e define memória e CPU para o container

docker container attach [CONTAINER_ID]                # conecta-se ao processo principal do container, porém o container deve estar em execução

docker container exec -ti [CONTAINER_ID] [COMANDO]    # executa container e executa comando

docker container start [CONTAINER_ID]                 # inicia container

docker container stop [CONTAINER_ID]                  # para container

docker container restart [CONTAINER_ID]               # reinicia container

docker container pause [CONTAINER_ID]

docker container unpause [CONTAINER_ID]

docker container inspect [CONTAINER_ID]               # exibe configuração do container

docker container logs -f [CONTAINER_ID]               # exibe logs do container

docker container rm [CONTAINER_ID]                    # remove container
docker container rm -f [CONTAINER_ID]                 # força a remoção do container 

docker container stats [CONTAINER_ID]                 # exibe estatísticas do container

docker container update --memory 64M --cpus 0.4 nginx # atualiza configuração de memória e CPU do container. Pode ser feito o update de qualquer configuração do container

docker container update -m 128M --cpus 0.4 nginx      # atualiza configuração de memória e CPU do container

docker container top [CONTAINER_ID]                   # exibe processos do container

docker image build -t edtroleis/image001:1.0.0 .      # cria imagem

ctrl +pq                                              # sai do container sem terminá-lo

# Stress test de containers
docker container run -d nginx
docker container exec -it [CONTAINER_ID] /bin/bash
apt-get update && apt-get install -y stress
stress --cpu 1 --vm-bytes 128M --vm 1

# Em outro terminal verifique as statísticas do container
docker container stats [CONTAINER_ID]







### Volumes
No docker existem dois tipos de volumes: tipo volume e tipo bind

- tipo bind: já possuo um diretório e quero que esse diretório seja montado no container
mkdir /opt/dir1
docker container run -it --mount type=bind,src=/opt/dir1:dest=/opt/dir1 ubuntu bash

- tipo volume
docker volume ls
docker volume create vol1
docker volume inspect vol1
ls -ltr /var/lib/docker/volumes
docker container run -it --mount type=volume,src=vol1,dst=/dir1 ubuntu
docker volume rm vol1

